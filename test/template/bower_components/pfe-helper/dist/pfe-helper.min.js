/**
 * Helper functionalities for PF-E
 * @version v1.0.0-dev-2015-10-21
 * @link http://personalfinance-technology-pf.sfdi.echonet/Support-teo/HTML5-JS/Default.htm
 * @license BNPP-PF Techonology & Support */
!function(a,b,c){function d(a,b){function c(c,d,e){b.error(c,e),a.error("Error: "+c,d)}function d(c,d,e){b.info(c,e),a.info("Info: "+c,d)}function e(c,d,e){b.success(c,e),a.info("Success: "+c,d)}function f(c,d,e){b.warning(c,e),a.warn("Warning: "+c,d)}var g={showToasts:!1,error:c,info:d,success:e,warning:f,log:a.log};return g}function e(a,b){function c(c){return function(d){var e,f=c;return d.data&&d.data.description&&(e="\n"+d.data.description,f=c+e),b.error(f),a.reject(d)}}var d={catcher:c};return d}function f(){this.config={appErrorPrefix:null,appTitle:null},this.configure=function(a){this.config.appErrorPrefix=a.appErrorPrefix,this.config.appTitle=a.appTitle},this.$get=function(){return{config:this.config}}}function g(a){a.decorator("$exceptionHandler",h)}function h(a,c,d,e){return function(f,g){var h=c.config.appErrorPrefix||"",i=c.config.appTitle||"",j={exception:f,cause:g};f.message=h+f.message,d.error(f.message,j);try{var k={app:i,location:e.location.href,message:f.message,cause:g||""};$.ajax({type:"POST",url:"rest/V1/person/js/traceError",contentType:"application/json",data:b.toJson(k)}).done(function(){d.log("Error has been recorded to our server.")}).fail(function(a){var b=a.responseText+a.status+" "+a.statusText;d.log("Error server-side logging failed\n"+b)})}catch(l){d.warning("Error server-side logging failed\n"+l)}a(f,g)}}function i(a,c,d){function e(a,e,g,h){function i(a,e){a.forEach(function(a){a.config.resolve=b.extend(a.config.resolve||{},f.resolveAlways),c.state(a.state,a.config)}),e&&!o&&(o=!0,d.otherwise(e))}function j(){e.$on("$stateChangeError",function(b,c,d,e,f,g){if(!n){p.errors++,n=!0;var i=c&&(c.title||c.name||c.loadedTemplateUrl)||"unknown target",j="Error routing to "+i+". "+(g.data||"")+". <br/>"+(g.statusText||"")+": "+(g.status||"");h.warning(j,[c]),a.path("/")}})}function k(){j(),m()}function l(){return g.get()}function m(){e.$on("$stateChangeSuccess",function(a,b){p.changes++,n=!1;var c=f.docTitle+" "+(b.title||"");e.title=c})}var n=!1,o=!1,p={errors:0,changes:0},q={configureStates:i,getStates:l,stateCounts:p};return k(),q}var f={docTitle:null,resolveAlways:{}};this.configure=function(a){b.extend(f,a)},this.$get=e,e.$inject=["$location","$rootScope","$state","logger"]}b.module("pfe.helper.router",["ui.router","pfe.helper.logger"]),b.module("pfe.helper.exception",["pfe.helper.logger"]),b.module("pfe.helper.logger",[]),b.module("pfe.helper",["pfe.helper.logger","pfe.helper.exception","pfe.helper.router"]),d.$inject=["$log","toastr"],b.module("pfe.helper.logger").factory("logger",d),e.$inject=["$q","logger"],b.module("pfe.helper.exception").factory("exception",e),g.$inject=["$provide"],h.$inject=["$delegate","exceptionHandler","logger","$window"],b.module("pfe.helper.exception").provider("exceptionHandler",f).config(g),i.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"],b.module("pfe.helper.router").provider("routerHelper",i)}(window,window.angular);